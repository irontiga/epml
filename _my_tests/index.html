<!DOPCTYPE html>
<html>
    <head>

    </head>
    <body>
        <iframe src="frame1.html" id="frame1"></iframe>

        <script type="module">
            import Epml from '../src/Epml.js'

            // Install worker plugin, not default...for now
            import contentWindowPlugin from '../src/plugins/contentWindows/contentWindows.js'
            Epml.registerPlugin(contentWindowPlugin)
            

            document.addEventListener("DOMContentLoaded", function (event) {
                const frameElement = document.getElementById('frame1')

                const frameEpml = new Epml({ type: 'WINDOW', source: frameElement })

                // console.log(frameEpml)

                frameEpml.ready().then(() => {
                    console.log('Frame ready :)')
                    setInterval(() => {
                        frameEpml.request('hi').then(res => console.log(`Time elapsed: ${res} seconds`))
                    }, 3000)
                })

                frameEpml.imReady()

            })

            
            
        </script>
    </body>
</html>